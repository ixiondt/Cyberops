# Agent Integration Guide
**How Each CyberPlanner Agent Role Contributes to POAM Generation**

---

## Overview

Your three specialized agent roles contribute findings that drive POAM creation. This guide explains:
- **What findings each agent generates**
- **How findings translate to POAMs**
- **When to involve each agent in POAM process**
- **Cross-functional coordination**

---

## Cyber Operations Planner Role

### Responsibilities in POAM Process

**Phase 1: Finding Classification**
- Receives findings from Host/Network Analysts
- Applies doctrine-based risk assessment (ADP 5-0, FM 3-12)
- Classifies findings by MDMP risk framework
- Coordinates finding prioritization across response team

**Phase 2: POAM Governance**
- Aligns POAMs with OPORD Task Organization
- Ensures proper authority/approval chain
- Identifies doctrine-aligned remediation procedures
- Integrates POAMs into cyber running estimate

**Phase 3: Risk Coordination**
- Escalates CRITICAL findings to commander
- Coordinates resource allocation (if conflicts)
- Documents residual risk in MDMP framework
- Tracks POAMs in running estimate

### Findings Generated by Planner

**Type 1: Operational Risk Findings**
- Doctrine-based capability gaps
- Authority/approval gaps
- Coordination failures
- Procedure deviations from FM 3-12/ATP 3-12.3

**Example Finding:**
"Response deviated from cyber task organization per FM 3-12. POAM needed to re-establish proper tasking and C2 for future operations."

→ **Converts to POAM:** Process/Procedure Gap, MEDIUM priority

---

**Type 2: Cross-Functional Coordination Findings**
- Missing integration between response elements
- Information flow gaps
- Synchronization failures

**Example Finding:**
"Host Team and Network Team findings not correlated. POAM needed for joint analysis and threat COA development."

→ **Converts to POAM:** Incomplete Investigation, MEDIUM priority

---

**Type 3: Strategic Risk Findings**
- Capability gaps (e.g., no malware analysis capability)
- Authority gaps (e.g., no clear authority to remediate)
- Doctrine/policy gaps

**Example Finding:**
"Remediation authority unclear for production system PROD-SQL-01. POAM needed to coordinate with system owner and obtain proper approval."

→ **Converts to POAM:** Process Gap, HIGH priority (blocking further remediation)

---

### POAMs Created by Planner

| POAM Category | Example Title | Timeline | Owner |
|---|---|---|---|
| Procedure Gap | Document cyber response procedures per ATP 5-0.2.1 | 14-30 days | Element Lead + Training |
| Incomplete Investigation | Correlate Host/Network findings and develop threat COA | 7-14 days | Planner + Analysts |
| Coordination Gap | Establish joint Host/Network analysis protocol | 7-21 days | Element Lead + Team Leads |
| Authority Gap | Clarify remediation authority for production systems | 3-7 days | Element Lead + S-1 |
| Doctrine Alignment | Verify cyber tasking aligns with FM 3-12 structure | 7-14 days | Planner |

---

## 17C Host Analyst Role

### Responsibilities in POAM Process

**Phase 1: Finding Documentation**
- Identifies host-level findings during endpoint analysis
- Documents findings with technical detail and evidence
- Correlates findings with MITRE ATT&CK techniques
- Provides baseline deviation analysis (ATP 2-01.3 persona layer)

**Phase 2: POAM Input**
- Provides technical remediation guidance for host POAMs
- Specifies verification procedures (EDR clean, reimage complete)
- Recommends hardening measures (baseline application)
- Identifies ongoing monitoring requirements

**Phase 3: Verification & Closure**
- Validates POAM completion milestones
- Verifies endpoint remediation (clean state)
- Confirms baseline application
- Performs post-remediation artifact collection

### Findings Generated by Host Analyst

**Type 1: Malware Findings**
- Specific malware detected on endpoint
- Malware family, hash, persistence mechanism
- Indicators for detection/monitoring
- Lateral movement or data access indicators

**Example Finding:**
"Malware Trojan.Win32.Emotet found on WIN-USR-0847 with persistence via Run registry key. Memory analysis shows DLL injection into svchost.exe. C2 callback observed to 192.168.1.50:443."

→ **POAM Type:** MALWARE (CRITICAL)

→ **Milestones:**
1. Isolate endpoint (Immediate)
2. Collect memory dump and sample (Day 1)
3. Analyze malware capabilities (Day 1-2)
4. Reimage endpoint (Day 2-3)
5. Verify clean (EDR negative, no suspicious indicators) (Day 3-5)
6. Harden per baseline (Day 5-7)
7. 30-day monitoring for recurrence (Day 7-37)

---

**Type 2: Suspicious Process/Activity Findings**
- Unusual process detected but benign or unclear
- Service activity unexplained
- Scheduled task suspicious
- User activity baseline deviation

**Example Finding:**
"Unusual PowerShell process observed running as SYSTEM with encoded script. Script decoded to create persistent WMI event subscriber. Unknown purpose, appears suspicious but not confirmed malicious."

→ **POAM Type:** INCOMPLETE INVESTIGATION + CONFIG DEFICIENCY

→ **Action:** Continue forensic analysis (INCOMPLETE INVESTIGATION POAM). If benign, remove if not authorized (CONFIG DEFICIENCY POAM).

---

**Type 3: Configuration Deviation Findings**
- System not meeting security baseline
- Unnecessary services enabled
- Permissions too permissive
- Audit logging disabled

**Example Finding:**
"Windows Firewall disabled on endpoint WIN-ADMIN-02. Inconsistent with security baseline (ATP 2-01.3 persona layer analysis). High-privilege account, elevated risk."

→ **POAM Type:** CONFIG_DEFICIENCY (HIGH)

→ **Remediation:** Re-enable Windows Firewall, re-apply baseline, audit scope of disabled protection period.

---

**Type 4: Credential/Account Findings**
- Suspicious account activity (logon patterns, resource access)
- Compromised account indicators
- Privilege escalation evidence
- Service account misuse

**Example Finding:**
"SVC_BACKUP account (service account) used for interactive logon from unexpected system WORKSTATION-99. Not authorized per account baseline. Possible credential compromise or lateral movement."

→ **POAM Type:** CREDENTIAL_COMPROMISE (HIGH) + Investigation (7 days)

→ **Action:** Audit account usage. Reset if compromised. Restrict service account logon rights per baseline.

---

### POAMs Created by Host Analyst

| POAM Category | Example Title | Timeline | Owner |
|---|---|---|---|
| Malware | Remove malware and harden endpoint WIN-USER-0847 | Days 0-7 | Host Team |
| Credential | Reset SVC_BACKUP and audit usage scope | Days 0-5 | S-1 + Host Analyst |
| Config Deficiency | Apply Windows Firewall baseline to WIN-ADMIN-02 | Days 1-5 | System Admin |
| Investigation | Analyze PowerShell script and determine purpose | Days 3-7 | Host Analyst |
| Detection Gap | Develop EDR detection for encoded PowerShell execution | Days 7-14 | S-2/SOC |

---

## 17C Network Analyst Role

### Responsibilities in POAM Process

**Phase 1: Finding Documentation**
- Identifies network-level findings during traffic analysis
- Documents findings with network architecture context (ATP 2-01.3 logical layer)
- Correlates with MITRE ATT&CK network techniques
- Provides choke point and lateral movement path analysis

**Phase 2: POAM Input**
- Provides detection rule guidance for network POAMs
- Specifies network segmentation improvements needed
- Recommends monitoring points and baselines
- Identifies network architecture changes required

**Phase 3: Verification & Closure**
- Validates detection rule deployment
- Confirms network segmentation implemented
- Verifies no suspicious traffic patterns post-remediation
- Performs network architecture validation

### Findings Generated by Network Analyst

**Type 1: C2/Beaconing Findings**
- Suspicious outbound connections to unknown external IP
- Regular connection patterns (beaconing)
- Command and control communication protocol
- Exfiltration channel identified

**Example Finding:**
"Endpoint WIN-USR-0847 initiates HTTPS connections to 203.0.113.50:443 every 5 minutes, regardless of system load or user activity. Pattern consistent with C2 beaconing. Connections blocked but not alerted by current detection rules."

→ **POAM Type:** DETECTION_GAP (HIGH) + Threat Intel (MEDIUM)

→ **Milestones:**
1. Validate connections are unauthorized (Day 0-1)
2. Block at firewall if not already (Day 1)
3. Collect network signatures (Day 1-2)
4. Develop detection rule (Day 3-7)
5. Deploy rule to NIDS/proxy (Day 7-10)
6. Monitor for rule effectiveness (Day 10+)

---

**Type 2: Lateral Movement Findings**
- Unusual traffic between systems
- Privilege escalation patterns
- Lateral movement tools detected (SMB, RDP, PSExec)
- Attack chain reconstructed from network data

**Example Finding:**
"Traffic spike from WORKSTATION-10 to multiple servers on network using SMB (port 445). Pattern consistent with lateral movement using file share enumeration. Destinations include file servers and administrative systems."

→ **POAM Type:** LATERAL_MOVEMENT (HIGH/CRITICAL) + Investigation

→ **Milestones:**
1. Reconstruct attack path (Day 0-1)
2. Audit affected systems for compromise (Day 1-3)
3. Segment network to prevent future lateral movement (Day 3-14)
4. Deploy detection rules for attack pattern (Day 7-14)
5. Verify segmentation effective (Day 14-21)

---

**Type 3: Data Exfiltration Findings**
- Unusual outbound data transfer
- Known exfiltration tool/pattern detected
- Large data volumes to external destination
- Encrypted tunnel to suspicious destination

**Example Finding:**
"High volume HTTPS traffic from internal file server FILE-SRV-02 to external IP 198.51.100.0 detected on 2024-02-23 22:00-23:30. Data volume ~500GB. Not explained by authorized backup or replication."

→ **POAM Type:** INVESTIGATION_INCOMPLETE (CRITICAL) + Threat Intel + Detection Gap

→ **Action:** Immediate investigation of exfiltration scope. If confirmed, activate incident response, assess damage, develop detection for pattern.

---

**Type 4: Network Baseline Deviation Findings**
- Traffic not matching normal operational patterns
- Unexpected protocol usage
- Unusual source/destination combinations
- Service running on non-standard port

**Example Finding:**
"Internal system SRV-APP-01 communicating on port 22 (SSH) to external IP 198.51.100.50. Not explained by authorized remote access policy. Baseline shows SSH disabled for this system."

→ **POAM Type:** CONFIG_DEFICIENCY (HIGH) + Investigation

→ **Milestones:**
1. Determine if authorized remote access (Day 0-1)
2. Block unauthorized access (Day 1)
3. If unauthorized, investigate scope (Day 1-3)
4. Re-apply hardened configuration (Day 3-5)
5. Implement network policy to prevent reoccurrence (Day 5-7)

---

### POAMs Created by Network Analyst

| POAM Category | Example Title | Timeline | Owner |
|---|---|---|---|
| Detection Gap | Deploy NIDS detection for C2 beaconing pattern | Days 7-14 | S-2/SOC |
| Lateral Movement | Network segmentation to prevent SMB lateral movement | Days 7-21 | Network Team + S-3 |
| Investigation | Determine exfiltration scope and timeline | Days 1-7 | Network Analyst + Threat Intel |
| Threat Intel | Correlate C2 IP with threat intelligence | Days 3-7 | S-2/Threat Intel |
| Configuration | Disable unauthorized SSH on SRV-APP-01 | Days 1-3 | System Admin |

---

## Cross-Functional Coordination

### When Multiple Agents Contribute to One POAM

**Scenario 1: Comprehensive Malware POAM**

```
Host Analyst Input:
  - Malware identification & removal procedure
  - Verification methods (EDR clean state)
  - Hardening requirements

Network Analyst Input:
  - C2 communication details
  - Exfiltration indicators
  - Network-based detection needs

Planner Input:
  - Priority classification (CRITICAL)
  - Task assignment (Host Team primary, S-2 secondary)
  - Authority coordination

→ SINGLE POAM with multi-faceted remediation milestones
```

---

**Scenario 2: Lateral Movement Investigation to Detection**

```
Network Analyst Input (Day 0-3):
  - Traffic patterns indicating lateral movement
  - Source/target systems identified
  - Attack path reconstructed

Host Analyst Input (Day 1-3):
  - Evidence on compromised systems
  - Privilege escalation confirmation
  - Access scope determination

→ Initial POAM: INVESTIGATION_INCOMPLETE (Network + Host Teams)

Upon completion, creates secondary POAMs:
  - LATERAL_MOVEMENT POAM (Network segmentation)
  - CONFIG_DEFICIENCY POAM (Host hardening)
  - DETECTION_GAP POAM (S-2 detection rule)
```

---

### Referral Protocol

**Host Analyst finding that requires Network analysis:**
```
"I found evidence of lateral movement, but only on this endpoint.
→ Refer to Network Analyst to assess network-wide lateral movement scope
→ Network creates POAM: Lateral Movement Investigation
```

**Network Analyst finding that requires Host analysis:**
```
"I see C2 traffic, but don't know which endpoint is calling home.
→ Refer to Host Analyst to identify source endpoint and malware
→ Host creates POAM: Malware Removal
```

**Either analyst finding that requires Planner input:**
```
"Finding is confirmed, but remediation authority is unclear.
→ Refer to Planner to coordinate authority and escalate if needed
→ Planner creates or escalates POAM to Element Lead
```

---

## POAM Creation Workflow by Agent

### Host Analyst Workflow

```
1. Conduct host analysis
2. Document findings (process, files, registry, logs)
3. Classify findings (malware/credential/config/etc.)
4. For findings requiring follow-up:
   ├─ Create finding summary document
   ├─ Correlate with MITRE ATT&CK techniques
   ├─ Provide remediation guidance
   ├─ Specify verification procedures
   └─ Refer to Planner for POAM creation
5. Provide input to POAM_Template sections:
   ├─ Section 1: Finding details (technical)
   ├─ Section 3: Remediation steps (host-specific)
   ├─ Section 5: Execution plan (forensic procedures)
   ├─ Section 5: Verification procedures (EDR/baseline checks)
   └─ Section 6: Monitoring needs (behavioral monitoring)
```

---

### Network Analyst Workflow

```
1. Conduct network analysis
2. Document findings (traffic patterns, protocols, destinations)
3. Classify findings (C2/lateral movement/exfil/detection gap/etc.)
4. For findings requiring follow-up:
   ├─ Create finding summary document
   ├─ Map to network layer (logical terrain per ATP 2-01.3)
   ├─ Correlate with MITRE ATT&CK techniques
   ├─ Provide detection/segmentation guidance
   └─ Refer to Planner for POAM creation
5. Provide input to POAM_Template sections:
   ├─ Section 1: Finding details (traffic/protocol)
   ├─ Section 3: Remediation steps (detection/segmentation)
   ├─ Section 5: Execution plan (detection rule deployment)
   ├─ Section 5: Verification procedures (traffic validation)
   └─ Section 6: Monitoring needs (traffic baseline monitoring)
```

---

### Cyber Operations Planner Workflow

```
1. Receive findings from Host and Network Analysts
2. Apply risk assessment framework:
   ├─ Score likelihood and impact
   ├─ Classify POAM type and priority
   ├─ Identify responsible owner from Task Organization
   └─ Determine authority approval requirements
3. Create or coordinate POAM creation:
   ├─ Complete POAM_Template with guidance from analysts
   ├─ Specify MDMP-aligned timeline
   ├─ Ensure proper authority chain
   ├─ Coordinate inter-team dependencies
   └─ Assign to responsible owner
4. Manage POAM lifecycle:
   ├─ Track in POAM_Tracker.md
   ├─ Escalate CRITICAL items to commander
   ├─ Coordinate resource conflicts
   ├─ Verify closure milestones
   └─ Document residual risk
5. Update running estimate with POAM status
```

---

## Communication Triggers

### When to Involve Host Analyst in POAM Process

- ☐ POAM requires verification of endpoint clean state
- ☐ POAM includes hardening or configuration changes
- ☐ Monitoring requirements need EDR-specific implementation
- ☐ Remediation involves re-imaging or system rebuild

**Question to ask:** "Does this POAM require endpoint-level action or verification?"

---

### When to Involve Network Analyst in POAM Process

- ☐ POAM includes detection rule development
- ☐ POAM involves network segmentation or firewall rules
- ☐ Remediation includes traffic-based detection or blocking
- ☐ Lateral movement or C2 findings need network response

**Question to ask:** "Does this POAM require network-level action or detection?"

---

### When to Involve Cyber Operations Planner in POAM Process

- ☐ Finding classification and risk prioritization needed
- ☐ Authority/approval coordination required
- ☐ Multi-team coordination needed
- ☐ Integration with MDMP or OPORD required
- ☐ Escalation to commander needed (CRITICAL findings)

**Question to ask:** "Does this finding need strategic/operational context or authority coordination?"

---

## POAM Status Briefing Template (For Agents)

**When asked to brief on POAM status, use this structure:**

```
POAM ID: [ID] | Title: [Title]
Status: [Open/In Progress/At Risk/Complete/Closed]
Priority: [CRITICAL/HIGH/MEDIUM/LOW]
Owner: [Name/Team]
Target Date: [DATE]

Progress:
  - Completed: [Milestone X as of DATE]
  - In Progress: [Milestone Y, % complete]
  - Next: [Milestone Z, target DATE]

Blockers/Issues:
  - [Issue 1]: [Description and impact]
  - [Issue 2]: [Description and impact]

Resources/Support Needed:
  - [Request]

Questions/Escalations:
  - [Question for Planner/Element Lead]
```

---

## Reference Documents

- **POAM_Template.md** — Template each agent contributes to
- **Finding_to_POAM_Mapping.md** — Classification guidance
- **Risk_Prioritization.md** — Priority scoring methodology
- **POAM_Generation_Guide.md** — Step-by-step generation process
- **INDEX.md** — Master reference for finding types and POAM categories

---

**Last Updated:** 2026-02-24
**Classification:** UNCLASSIFIED // FOUO
