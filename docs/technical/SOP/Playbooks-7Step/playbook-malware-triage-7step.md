# MALWARE TRIAGE — INCIDENT RESPONSE PLAYBOOK
## 7-Step Framework | UNCLASSIFIED // FOUO

**Playbook ID:** IR-PB-001
**Version:** 1.0
**Classification:** UNCLASSIFIED // FOUO
**Threat Type:** Malware — Initial Triage (Unknown Sample / Suspected Infection)
**Primary Role:** 17C Host Analyst
**Authority:** CJCSM 6510.01B | AR 25-2 | FM 3-12 | ATP 3-12.3
**Created:** 2026-02-25
**Review Cycle:** Semi-annual or post-CAT I/II incident

**MITRE ATT&CK Primary Tactics:**
- T1059 — Command and Scripting Interpreter
- T1204 — User Execution
- T1566 — Phishing (common delivery vector)
- T1105 — Ingress Tool Transfer
- T1027 — Obfuscated Files or Information

---

## BLUF

Malware triage is the initial, time-critical phase of responding to a suspected malware infection. The goal is **not** full analysis — it is rapid classification, scope estimation, and severity determination to inform containment decisions. Move fast, preserve evidence, brief leadership within the CJCSM-required window.

**This playbook applies when:** An alert fires, a file is flagged, unusual process behavior is observed, or an analyst suspects malware presence on one or more hosts.

**Output of triage:** Confirmed/denied malware presence, CAT classification, applicable response playbook selected, Mission OIC notified.

---

## STEP 1: PREPARATION

### 1.1 Required Capabilities (Pre-Incident)
| Capability | Tool Category | Purpose |
|-----------|--------------|---------|
| EDR platform | Endpoint Detection & Response | Process telemetry, file detections, containment |
| SIEM | Log correlation | Alert aggregation, timeline correlation |
| Isolated sandbox | Dynamic analysis | Safe malware execution |
| Static analysis workstation | Reverse engineering | Offline file examination (no network) |
| Forensic imaging | Evidence preservation | Bit-for-bit system capture |
| Hash lookup access | Threat intel | VirusTotal / internal TI platform |
| Baseline documentation | Reference | Known-good processes, services, file inventory |

### 1.2 Required Authorities (Validate Before Incident)
- [ ] DCO / CSSP standing authority to investigate hosts on supported network
- [ ] System Owner coordination SOP established (who to call, response SLA)
- [ ] Forensic collection authority documented (Annex J or equivalent)
- [ ] ARCYBER/USCYBERCOM reporting channel confirmed

### 1.3 Pre-Incident Checklist
- [ ] EDR agents deployed on all in-scope hosts
- [ ] SIEM receiving logs from all critical hosts (endpoint, auth, DNS, proxy)
- [ ] Malware sample handling procedure documented and trained
- [ ] Sandbox environment tested and validated
- [ ] Analyst team trained on triage methodology
- [ ] Notification contacts current (Mission OIC, System Owner, ARCYBER)

### 1.4 Baseline Data Required
- Known-good process tree for each OS type in environment
- Approved scheduled tasks, services, and startup entries
- Standard network connections (DNS servers, update servers, management consoles)
- Software inventory (approved applications)

---

## STEP 2: DETECTION & IDENTIFICATION

### 2.1 Detection Sources
| Source | What It Detects |
|--------|----------------|
| EDR alert | Process injection, suspicious execution, file creation, registry modification |
| SIEM correlation | Multi-host patterns, sequential alerting, volume anomalies |
| Antivirus/NGAV | Signature matches, heuristic flags |
| User report | Unusual system behavior, pop-ups, performance degradation |
| Network anomaly (NDR/NIDS) | Unexpected outbound connections, protocol anomalies |
| Threat hunt | Proactive discovery of IOCs matching threat intelligence |

### 2.2 Initial Triage Questions (Answer Before Any Action)
1. **What system(s) are affected?** (hostname, IP, function/criticality)
2. **What is the detection source and confidence?** (EDR hit vs. user report)
3. **When did this start?** (first event timestamp)
4. **Is the malware active or dormant?** (processes running, network connections active)
5. **What user/account context is it running under?** (admin vs. standard user)
6. **Is there evidence of lateral movement already?** (other hosts showing similar indicators)

### 2.3 Triage Workflow
```
ALERT RECEIVED
     │
     ▼
Is this a true positive?  ──No──► Document false positive, tune detection, CLOSE
     │ Yes
     ▼
What is the malware doing? (passive observe, DO NOT remediate yet)
     │
     ├── Executing actively (process running) ──► HIGH URGENCY: Step 3 immediately
     │
     ├── Dormant/staged (file present, not executing) ──► MEDIUM: Steps 2.4 → 2.6 first
     │
     └── Evidence of prior execution only ──► Complete triage, then Steps 3–4
```

### 2.4 Sample Collection (Preserve Before Analysis)
**DO NOT** execute or open unknown files on a networked, production system.

Priority artifacts to collect:
- Suspicious file(s) with full filesystem metadata (creation/modification/access times)
- Parent process information (what launched this)
- Command-line arguments used to execute
- Any associated files created in same timeframe
- Relevant event logs (Security, System, Application, PowerShell/ScriptBlock)
- Registry keys modified in same timeframe
- Network connections at time of execution

### 2.5 Static Analysis (Quick Triage — 15-30 Minutes)
1. **Hash the sample** (MD5, SHA256, SSDEEP) — lookup in TI platform / VirusTotal
2. **Check file type** (extension vs. actual file magic bytes — mismatch = suspicious)
3. **Examine file size** (unexpectedly small or large for type)
4. **Scan with available AV/YARA** rules
5. **Check digital signature** (signed by legitimate vendor or unsigned/self-signed)
6. **Extract strings** (embedded IPs, domains, registry keys, commands — capability-level indicators)

### 2.6 Severity Classification
| Indicator | CAT I (Critical) | CAT II (High) | CAT III (Medium) | CAT IV (Low) |
|-----------|:----------------:|:-------------:|:----------------:|:------------:|
| Admin/SYSTEM execution | ✓ | | | |
| DC / critical infrastructure | ✓ | | | |
| Active C2 communication | ✓ | | | |
| Credential access detected | ✓ | | | |
| Standard user execution | | ✓ | | |
| Lateral movement attempted | | ✓ | | |
| Dormant/staged, no execution | | | ✓ | |
| Signature match, quarantined | | | | ✓ |

### 2.7 Mission OIC Notification Trigger
Notify Mission OIC immediately if ANY of the following:
- Active malware executing under admin/SYSTEM context
- Domain controller or mission-critical system affected
- Multiple hosts affected (potential outbreak)
- Active C2 beaconing detected
- Credential access or dumping suspected

**Notification format:** "INCIDENT [CAT X] — Suspected malware on [SYSTEM] — [WHAT IT'S DOING] — Recommend [CONTAINMENT ACTION] — Awaiting approval."

---

## STEP 3: CONTAINMENT

### 3.1 Containment Decision Matrix
| Situation | Immediate Action | Approval Required |
|-----------|-----------------|-------------------|
| Active malware, non-critical host | EDR-isolate host | Element Lead |
| Active malware, critical/production host | Coordinate with System Owner, isolate after notification | Mission OIC + System Owner |
| Malware dormant, non-critical host | Forensic preserve, then isolate | Element Lead |
| Multiple hosts affected | Isolate all affected, segment network | Mission OIC |
| C2 active | Block C2 at network boundary | Mission OIC + Network Analyst |

### 3.2 Short-Term Containment (Immediate — 0 to 1 hour)
**Goal:** Stop the bleeding without destroying evidence.

- [ ] **Preserve forensic state** — Take memory dump and disk image BEFORE any remediation
- [ ] **Network isolation** — Remove affected host from network (EDR containment or physical disconnect)
- [ ] **Block identified C2** — If C2 IP/domain identified, push block to firewall/proxy
- [ ] **Disable compromised accounts** — If credential access suspected, disable affected accounts
- [ ] **Alert System Owner** — Notify of containment action per ROE/coordination plan
- [ ] **Document everything** — Time-stamped log of every action taken (who/what/when/why)

### 3.3 Long-Term Containment (Sustained — until eradication complete)
**Goal:** Maintain isolation while full analysis and eradication proceed.

- [ ] **Secondary imaging** — Ensure forensic copy available for analysis without disturbing original
- [ ] **Segment network** — Apply firewall/VLAN rules to prevent lateral spread from affected segment
- [ ] **Monitor perimeter** — Increase monitoring on egress points for C2 callbacks from other hosts
- [ ] **Credential lockdown** — If admin credentials compromised, force rotation before restoring access
- [ ] **Identify backup/failover** — Activate clean backup system for mission continuity if needed

### 3.4 Evidence Preservation Checklist
- [ ] Disk image (bit-for-bit, hash verified)
- [ ] Memory dump (if malware executing at time of collection)
- [ ] Network connection state at time of collection
- [ ] All relevant event logs exported
- [ ] Original sample preserved with hash documentation
- [ ] Chain of custody established (who collected, when, storage location)

---

## STEP 4: ERADICATION

### 4.1 Confirm Full Scope Before Eradication
**Do NOT eradicate until you know the full scope.** Partial eradication allows re-infection.

- [ ] All affected hosts identified (lateral movement analysis complete)
- [ ] All persistence mechanisms catalogued (scheduled tasks, services, registry, WMI)
- [ ] Initial access vector identified (phishing, exploit, insider, removable media)
- [ ] C2 infrastructure fully documented (all known IPs/domains)

### 4.2 Eradication Actions
1. **Remove malware artifacts**
   - Delete malicious files from all identified locations
   - Remove associated temp files and staged payloads
   - Rescan after removal to confirm clean state

2. **Remove persistence mechanisms**
   - Delete malicious scheduled tasks
   - Remove registry run keys, startup entries
   - Remove malicious services
   - Remove WMI event subscriptions

3. **Close initial access vector**
   - Patch exploited vulnerability
   - Remove/block phishing-associated email artifacts
   - Enforce credential reset for compromised accounts
   - Remove unauthorized remote access tools/accounts

4. **Update detection signatures**
   - Push new YARA rules and IOC signatures to EDR/SIEM based on this sample
   - Test signatures against collected sample to validate

### 4.3 Validation
- [ ] Full rescan of affected hosts with updated signatures — result: CLEAN
- [ ] Persistence mechanism check — all known locations clear
- [ ] Process tree review — no suspicious processes or parent-child anomalies
- [ ] Network connection review — no C2 callbacks observed post-eradication

---

## STEP 5: RECOVERY

### 5.1 Restoration Options (In Priority Order)
1. **Clean rebuild** — Reimage from known-good baseline (preferred for heavily compromised systems)
2. **Clean backup restore** — Restore from backup taken BEFORE compromise date (verify backup clean)
3. **Manual remediation + hardening** — For systems where rebuild/restore not feasible (document risk)

### 5.2 Hardening Before Restoration
- Apply all outstanding patches to restored system
- Enforce least privilege (remove unnecessary admin rights)
- Enable enhanced logging (PowerShell ScriptBlock, Sysmon if available)
- Confirm EDR agent deployed and functioning post-restoration
- Validate host against security baseline

### 5.3 Recovery Validation Checklist
- [ ] System operating normally (functional testing passed)
- [ ] No malware indicators detected post-restoration
- [ ] All security controls in place and validated
- [ ] System Owner sign-off obtained
- [ ] System returned to network with enhanced monitoring active

### 5.4 Enhanced Monitoring (30-Day Minimum)
- Increase EDR sensitivity on recovered host
- Add host to SIEM watchlist
- Alert on any re-emergence of original IOCs
- Weekly review of host telemetry for 30 days post-recovery

---

## STEP 6: POST-INCIDENT ANALYSIS

### 6.1 Incident Timeline Reconstruction
Document complete timeline from initial access to recovery:
```
[DATE/TIME] Initial access / suspected infection date (from forensic artifacts)
[DATE/TIME] First malicious activity on host
[DATE/TIME] Detection event (what alerted first)
[DATE/TIME] Analyst notified
[DATE/TIME] Mission OIC notified
[DATE/TIME] Containment action taken
[DATE/TIME] Forensic collection complete
[DATE/TIME] Eradication complete
[DATE/TIME] System restored
[DATE/TIME] Enhanced monitoring active
[DATE/TIME] Final report submitted
```

### 6.2 Root Cause Analysis
Determine and document:
- **Initial access vector** — How did malware get in? (Phishing / exploit / supply chain / removable media)
- **Execution enabler** — What allowed it to run? (Missing AV, disabled EDR, excessive permissions)
- **Detection gap** — Why wasn't it detected sooner? (Signature gap, log gap, blind spot)
- **Response delay** — Was there any avoidable delay? (Alert noise, staffing, tool failure)

### 6.3 MITRE ATT&CK Full Mapping
Document all observed techniques across the kill chain:
```
Initial Access:    [T-codes]
Execution:         [T-codes]
Persistence:       [T-codes]
Privilege Escal:   [T-codes]
Defense Evasion:   [T-codes]
Credential Access: [T-codes]
Discovery:         [T-codes]
Lateral Movement:  [T-codes]
Collection:        [T-codes]
C2:                [T-codes]
Exfiltration:      [T-codes]
Impact:            [T-codes]
```

### 6.4 Lessons Learned Products
- [ ] Detection rule updates (new signatures for this sample/family)
- [ ] Playbook updates (any gap in this playbook identified)
- [ ] Training recommendations (if analyst skill gap contributed)
- [ ] Architecture recommendations (if detection blind spot contributed)
- [ ] POA&M entries (if remediation requires longer-term tracking)

---

## STEP 7: COORDINATION & REPORTING

### 7.1 Notification Timeline (CJCSM 6510.01B Compliance)
| Event | Recipient | Deadline | Format |
|-------|-----------|----------|--------|
| CAT I/II detection | Mission OIC | Immediately | Voice + written |
| CAT I/II detection | ARCYBER / Higher HQ | Within 1 hour | SPOT report |
| CAT I/II detection | System Owner | Within 1 hour | Coordinated with Mission OIC |
| CAT III/IV detection | Mission OIC | Within 8 hours | Written |
| Containment action | System Owner | Before action (if feasible) | Coordinated |
| Final report | All recipients | Within 72 hours of closure | Incident report |

### 7.2 Required Reports
1. **Initial Incident Report** — Submitted upon CAT classification
   - Incident ID, date/time, affected system(s), detection method, initial actions, severity
2. **Status Update Reports** — Every 12 hours for CAT I/II until containment
3. **Containment Report** — Upon containment completion
4. **Final Incident Report** — Upon incident closure (includes root cause, timeline, remediation)

### 7.3 MOC/COP Updates
- Update incident tracker in Operations Dashboard (Incidents tab)
- Brief incident in daily SITREP
- Maintain PIR/RFI tracker updates if incident informs collection priorities

### 7.4 Incident Closure Criteria
This incident is CLOSED when:
- [ ] Malware fully identified (family, capabilities, IOCs documented)
- [ ] All affected systems identified and remediated
- [ ] Eradication validated (clean rescan on all hosts)
- [ ] 30-day post-recovery monitoring period complete with no recurrence
- [ ] Final incident report submitted and acknowledged
- [ ] Lessons learned incorporated into playbooks and detection rules
- [ ] PAR/AAR conducted and documented

---

## QUICK REFERENCE CARD

```
MALWARE TRIAGE DECISION FLOW
────────────────────────────
DETECT → True positive?
         YES: Hash + Static analysis
         NO: Document, tune, close

RUNNING AS ADMIN? → YES: Notify OIC NOW → Isolate
                    NO: Continue triage

MULTIPLE HOSTS? → YES: Outbreak playbook (IR-PB-002)
                  NO: Continue triage

C2 ACTIVE? → YES: Network Analyst → Block C2 → Notify OIC
             NO: Containment (isolate host)

FORENSIC IMAGE FIRST → THEN ERADICATE
```

---

**Classification:** UNCLASSIFIED // FOUO
**Playbook ID:** IR-PB-001 | Malware Triage
**Prepared By:** CyberOpsPlanner System
**Date:** 2026-02-25
**Related Playbooks:** IR-PB-002 (Malware Outbreak), IR-PB-010 (Persistence Response)
**Technical Reference:** `docs/technical/SOP/(d) malware-triage-playbook.docx`
